<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EduMelody</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#7cc58f">
  <link rel="stylesheet" href="styles.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Silkscreen:wght@400;700&family=Space+Grotesk:wght@400;600&display=swap" rel="stylesheet">
</head>
<body>
  <header>
    <div class="header-left">
      <h1 data-i18n="appTitle">EduMelody</h1>
    </div>
    <div id="button-controls">
      <button id="play-pause-button" aria-label="Play" data-i18n-title="play">
        <svg class="icon icon-play" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M8 5l11 7-11 7V5z"></path>
        </svg>
        <svg class="icon icon-pause" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M6 5h4v14H6V5zm8 0h4v14h-4V5z"></path>
        </svg>
        <span id="play-pause-label" class="button-label">Play</span>
      </button>
      <button id="clear-button" aria-label="Clear" data-i18n-title="clear">
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M9 3h6l1 2h4v2H4V5h4l1-2zm1 6h2v9h-2V9zm4 0h2v9h-2V9z"></path>
        </svg>
        <span class="button-label" data-i18n="clear">Clear</span>
      </button>
      <button id="randomize-button" aria-label="Randomize" data-i18n-title="randomize">
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M4 7h4l4 4 4-4h4v2h-3.17l-3.83 3.83L9.17 9H4V7zm16 8h-4l-4-4-4 4H4v2h3.17l3.83-3.83L14.83 17H20v-2z"></path>
        </svg>
        <span class="button-label" data-i18n="randomize">Randomize</span>
      </button>
      <button id="download-button" aria-label="Download WAV" data-i18n-title="download">
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 3v10l3-3 1.4 1.4-5.4 5.4-5.4-5.4L7 10l3 3V3h2zm-7 16h14v2H5v-2z"></path>
        </svg>
        <span class="button-label" data-i18n="download">Download WAV</span>
      </button>
    </div>
    <button id="controls-toggle" type="button" data-i18n="controlsHide">Hide controls</button>
    <div id="language-controls">
      <label for="language-select"><span data-i18n="language">Language</span>:</label>
      <select id="language-select">
        <option value="en">English</option>
        <option value="es">Español</option>
        <option value="ca">Català</option>
      </select>
      <button id="install-button" type="button" data-i18n-aria="installApp" data-i18n-title="installApp" hidden>
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 3v10l3-3 1.4 1.4-5.4 5.4-5.4-5.4L7 10l3 3V3h2zm-7 16h14v2H5v-2z"></path>
        </svg>
      </button>
      <button id="help-button" type="button" data-i18n-aria="helpTitle" data-i18n-title="helpTitle">
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 2a10 10 0 100 20 10 10 0 000-20zm0 15a1.25 1.25 0 110 2.5A1.25 1.25 0 0112 17zm1.6-5.6c-.9.6-1.1.9-1.1 2H11v-.4c0-1 .3-1.8 1.4-2.6.8-.6 1.1-1 1.1-1.7 0-1-1-1.6-2.1-1.6-1.2 0-2.1.7-2.2 1.9H7.7c.1-2.1 1.8-3.6 4-3.6 2.3 0 3.9 1.4 3.9 3.4 0 1.4-.7 2.3-2 3.2z"></path>
        </svg>
      </button>
    </div>
  </header>
  <main>
    <div id="grid-container"></div>
    <div id="controls-container">
      <div id="bpm-controls">
        <label for="tempo-slider"><span data-i18n="tempoLabel">Tempo</span>: <span id="tempo-value">120</span> <span data-i18n="bpmLabel">BPM</span></label>
        <input type="range" id="tempo-slider" min="100" max="200" value="120">
      </div>
      <div id="key-controls">
        <label for="tonic-select"><span data-i18n="tonic">Tonic</span>:</label>
        <select id="tonic-select">
          <option value="C">C</option>
          <option value="C#">C#</option>
          <option value="D">D</option>
          <option value="D#">D#</option>
          <option value="E">E</option>
          <option value="F">F</option>
          <option value="F#">F#</option>
          <option value="G">G</option>
          <option value="G#">G#</option>
          <option value="A">A</option>
          <option value="A#">A#</option>
          <option value="B">B</option>
        </select>
        <label for="scale-select"><span data-i18n="scale">Scale</span>:</label>
        <select id="scale-select">
          <option value="Major" data-i18n="major">Major</option>
          <option value="Minor" data-i18n="minor">Minor</option>
          <option value="PentatonicMajor" data-i18n="pentatonicMajor">Pentatonic (Major)</option>
          <option value="PentatonicMinor" data-i18n="pentatonicMinor">Pentatonic (Minor)</option>
          <option value="Lydian" data-i18n="lydian">Lydian</option>
          <option value="Mixolydian" data-i18n="mixolydian">Mixolydian</option>
          <option value="Dorian" data-i18n="dorian">Dorian</option>
          <option value="Phrygian" data-i18n="phrygian">Phrygian</option>
          <option value="Locrian" data-i18n="locrian">Locrian</option>
        </select>
      </div>
      <div id="note-controls">
        <label for="note-count-select"><span data-i18n="notes">Notes</span>:</label>
        <select id="note-count-select">
          <option value="8">8</option>
          <option value="16">16</option>
        </select>
      </div>
      <div id="pulse-controls">
        <label for="pulse-count-select"><span data-i18n="pulses">Pulses</span>:</label>
        <select id="pulse-count-select">
          <option value="8">8</option>
          <option value="16">16</option>
          <option value="32">32</option>
          <option value="64">64</option>
        </select>
      </div>
      <div id="instrument-controls">
        <label for="instrument-select"><span data-i18n="instrument">Instrument</span>:</label>
        <select id="instrument-select">
          <optgroup label="SoundFont">
            <option value="acoustic_grand_piano" selected data-i18n="piano">Piano</option>
            <option value="electric_piano_1" data-i18n="electricPiano">Electric Piano</option>
            <option value="acoustic_guitar_nylon" data-i18n="nylonGuitar">Nylon Guitar</option>
            <option value="lead_1_square" data-i18n="synthLead">Synth Lead</option>
          </optgroup>
          <optgroup label="Orquesta">
            <option value="violin" data-i18n="violin">Violin</option>
            <option value="viola" data-i18n="viola">Viola</option>
            <option value="cello" data-i18n="cello">Cello</option>
            <option value="acoustic_bass" data-i18n="contrabass">Contrabass</option>
            <option value="string_ensemble_1" data-i18n="stringEnsemble">String Ensemble</option>
            <option value="string_ensemble_2" data-i18n="stringEnsemble2">String Ensemble 2</option>
            <option value="flute" data-i18n="flute">Flute</option>
            <option value="piccolo" data-i18n="piccolo">Piccolo</option>
            <option value="oboe" data-i18n="oboe">Oboe</option>
            <option value="english_horn" data-i18n="englishHorn">English Horn</option>
            <option value="clarinet" data-i18n="clarinet">Clarinet</option>
            <option value="bassoon" data-i18n="bassoon">Bassoon</option>
            <option value="trumpet" data-i18n="trumpet">Trumpet</option>
            <option value="french_horn" data-i18n="frenchHorn">French Horn</option>
            <option value="trombone" data-i18n="trombone">Trombone</option>
            <option value="tuba" data-i18n="tuba">Tuba</option>
            <option value="timpani" data-i18n="timpani">Timpani</option>
          </optgroup>
          <optgroup label="Synth">
            <option value="sine" data-i18n="sine">Sine</option>
            <option value="triangle" data-i18n="triangle">Triangle</option>
            <option value="square" data-i18n="square">Square</option>
            <option value="sawtooth" data-i18n="sawtooth">Sawtooth</option>
          </optgroup>
        </select>
      </div>
      <div id="articulation-controls">
        <label for="articulation-select"><span data-i18n="articulation">Articulation</span>:</label>
        <select id="articulation-select">
          <option value="sustain" data-i18n="articulationSustain">Sustain</option>
          <option value="discrete" data-i18n="articulationDiscrete" selected>Discrete</option>
        </select>
      </div>
    </div>
  </main>
  <footer>&copy; 2025 EduMelody <span id="sw-version" class="sw-version" aria-hidden="true"></span></footer>
  <div id="help-overlay" aria-hidden="true">
    <div class="help-card" role="dialog" aria-modal="true" aria-labelledby="help-title">
      <div class="help-header">
        <h2 id="help-title" data-i18n="helpTitle">Help</h2>
        <button id="help-close" type="button" data-i18n-aria="helpClose">
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M18.3 5.7L12 12l6.3 6.3-1.4 1.4L10.6 13.4 4.3 19.7 2.9 18.3 9.2 12 2.9 5.7 4.3 4.3l6.3 6.3 6.3-6.3 1.4 1.4z"></path>
          </svg>
        </button>
      </div>
      <p class="help-intro" data-i18n="helpIntro">Create melodies by clicking the grid.</p>
      <ul class="help-list">
        <li data-i18n="helpStep1">Click a cell to activate a note.</li>
        <li data-i18n="helpStep2">Click again to extend the note (up to 4 steps). The color changes with duration.</li>
        <li data-i18n="helpStep3">After the longest duration, the next click clears the note.</li>
        <li data-i18n="helpStep4">Use Play to start/stop and adjust tempo, key, and scale.</li>
        <li data-i18n="helpStep5">Switch instruments anytime; SoundFonts load online.</li>
        <li data-i18n="helpStep6">Export your loop to WAV when ready.</li>
      </ul>
      <div class="help-shortcuts">
        <div class="help-shortcuts-title" data-i18n="helpShortcutsTitle">Shortcuts</div>
        <div class="help-shortcut"><kbd>Space</kbd> <span data-i18n="helpShortcutSpace">Play/Pause</span></div>
      </div>
    </div>
  </div>
  <div id="export-overlay" aria-hidden="true">
    <div class="export-card" role="status" aria-live="polite">
      <div class="export-title" data-i18n="exporting">Exporting WAV</div>
      <div class="export-bar">
        <div id="export-progress"></div>
      </div>
      <div class="export-percent"><span id="export-percent">0</span>%</div>
    </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/soundfont-player@0.12.0/dist/soundfont-player.min.js"></script>
  <script src="i18n.js"></script>
  <script src="script.js"></script>
</body>
</html>
